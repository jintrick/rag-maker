# Issue v0.4.0.1

## 前提知識
*   `tools/http_fetch.py`: 修正対象のツール。
*   `test/test_path_handling.py`: この問題を発見したテスト。
*   `.tmp/test_results.log`: 実際のエラーが記録されたログファイル。

## 経緯
v0.4.0の実装後、単体テストを実行したところ、Windows環境で`test_path_handling.py`が失敗することが確認された。テストログによると、特定の条件下でパスの扱いに問題が発生している。

## 現状の問題点
`http_fetch.py`ツールは、コマンドライン引数 `--temp-dir` に渡されたパスに引用符（`"` や `'`）が含まれていると、`OSError: [WinError 123] ファイル名、ディレクトリ名、またはボリューム ラベルの構文が間違っています。` というエラーを発生させてクラッシュする。

これは、現在のパス文字列のサニタイズ処理が不十分なためである。`strip()`やヘルパー関数 `_strip_all_wrapping_quotes` は、文字列の先頭と末尾の引用符しか除去できず、Windowsのシェルから渡されるようなパス文字列（例: `test_temp_http_fetch\"temp"`）を正しく処理できない。結果として、不正なパスが`pathlib.Path`に渡され、ディレクトリ作成時にOSエラーを引き起こしている。

## 解決策の概要
`http_fetch.py`内のパスサニタイズ処理を強化し、Windows環境でも引用符を含むパスを安全に扱えるようにする。

## 解決策の詳細
Julesへ。
`tools/http_fetch.py`を以下のように修正してください。

1.  `main`関数内にある、Windows向けのパスサニタイズ処理ブロックを探してください。
2.  現在の`strip()`と`_strip_all_wrapping_quotes()`を使った処理を、正規表現を用いたより堅牢な方法に置き換えてください。具体的には、`re.sub(r"['\"]", "", args.temp_dir).strip()` のようにして、パス文字列からシングルクォートとダブルクォートをすべて除去し、その後に前後の空白を削除します。
3.  この変更により、ヘルパー関数 `_strip_all_wrapping_quotes` は不要になりますので、ファイルから削除してください。
4.  `re`モジュールを使用するため、ファイルの先頭で `import re` を追加してください。

## 参考とすべきスクリプト等
*   `tools/http_fetch.py`

## テスト方法
Julesへ。

1.  `tools/http_fetch.py`に上記の修正を適用してください。
2.  その後、以前失敗したテストを再度実行してください: `python -m unittest test.test_path_handling.TestHttpPathHandlingIntegration`
3.  テストがすべて成功（`OK`）することを確認してください。特に、引用符を含むパスを渡した場合に`OSError`が発生しなくなったことを確認します。

## 実装状況

