# Issue v0.4.6: ナレッジベース完成時にGUIでディレクトリを開くツールの実装

## 前提知識
- docs/Architecture/Architecture.md
- .gemini/commands/rag.md

## 経緯
`/rag` コマンドは、指定された場所にナレッジベースを正常に作成できるようになった。しかし、ワークフロー完了後、ユーザーは次に何をすべきか、特に「どこに移動して `/ask` コマンドを使えばよいか」が分からないという問題がある。
CLI上でパスをテキスト表示するだけでは不親切であり、ユーザーが視覚的に完成を確認し、そこからシームレスに次のアクション（ターミナルを開いて `/ask` を実行）に移れるようにする必要がある。

## 現状の問題点
1.  **ユーザーへの案内不足**: `/rag` コマンドの成功後、ユーザーが次に取るべきアクション（作成されたナレッジベースへの移動）が明確に示されていない。
2.  **GUI連携ツールの欠如**: OSのファイルマネージャー（エクスプローラー等）を直接開くためのツールが存在しない。

## 解決策の概要
`samples/show_directory.py` をベースに、クロスプラットフォームで動作する新しいツール `open_directory` を実装する。
このツールは、`/rag` ワークフロー完了後、OSのデフォルトのファイルマネージャー（Windowsならエクスプローラー、macOSならFinder）で完成したナレッジベースのディレクトリを自動的に開く。
これにより、ユーザーは視覚的に完成を確認でき、そこからシームレスにターミナルを開いて `/ask` コマンドを実行できる。

## 解決策の詳細
1.  **`open_directory.py` ツールの新規作成**:
    -   **ベース**: `samples/show_directory.py` のWindows向けロジックを流用する。
    -   **機能**: 指定されたディレクトリパスを、OS標準のファイルマネージャーで開くクロスプラットフォーム対応ツール。
    -   **引数**:
        -   `--path`: 開きたいディレクトリパス。
    -   **実装**: `sys.platform` をチェックし、Windowsでは `explorer`、macOSでは `open`、Linuxでは `xdg-open` を `subprocess` で実行する。

2.  **`discovery.json` への登録**:
    -   作成した `open_directory` ツールを、プロジェクトルートの `discovery.json` に登録する。

3.  **`.gemini/commands/rag.md` のワークフロー修正**:
    -   最後の「完了報告」ステップを全面的に書き換える。
    -   AIエージェントに対し、`open_directory` ツールを `--path {{kb_root}}` で呼び出すよう指示する。
    -   ツール実行後、AIエージェントはCLI上で「ナレッジベースが作成されました。表示されたウィンドウ内でターミナルを開き、`/ask` コマンドで質問を開始してください。」といった補足メッセージを出力する。

## 参考とすべきスクリプト等
- `samples/show_directory.py` (本ツールのベースとなるスクリプト)

## テスト方法
1.  **`open_directory.py` の単体テスト**:
    -   `test/test_open_directory.py` を新規作成する。
    -   `subprocess.run` をモックし、各OS（`sys.platform`の値を変更）で正しいコマンドと引数が渡されることを確認する。
2.  **`/rag` コマンドの統合テスト**:
    -   `/rag` コマンドのワークフローを最後まで実行する。
    -   最終ステップで、OSのファイルマネージャーが起動し、作成されたナレッジベースのディレクトリが表示されることを目視で確認する。

## 実装状況