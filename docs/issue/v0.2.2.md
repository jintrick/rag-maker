# Issue v0.2.2: GitHubリポジトリからのドキュメント取得ツールの実装

## 前提知識
- `docs/Architecture/Architecture.md`

## 現状の問題点
- `/rag` コマンドがGitHubリポジトリから情報を収集する際、指定されたリポジトリ内のドキュメント（特にMarkdownファイルなど）を効率的かつ堅牢に取得するツールが存在しない。
- 大規模なリポジトリから必要なドキュメントのみを効率的に取得するメカニズム（例: スパースチェックアウト）を考慮する必要がある。

## 解決策の概要
- 指定されたGitHubリポジトリからドキュメントファイルを収集するPythonスクリプト `github_fetch.py` を作成する。
- このツールは、`/rag` コマンドのGitHubリポジトリからのデータ収集フローの中核を担う。

## 解決策の詳細
`github_fetch.py` は、以下の仕様を満たすツールとして実装される。

1.  **入力**:
    - `--repo-url`: 取得対象のGitHubリポジリのURL（例: `https://github.com/owner/repo`）。
    - `--branch` (オプション): 取得対象のブランチ名（デフォルト: `main` または `master`）。
    - `--temp-dir`: ドキュメントを一時的に保存するローカルディレクトリのパス。
    - --path-in-repo` (必須): リポジリ内でドキュメントを収集する対象のパス（例: `docs/`）。
2.  **コンテンツ取得**:
    - `GitPython` などのライブラリを使用して、指定されたGitHubリポジトリを `--temp-dir` にクローンまたは**スパースチェックアウトする**。
        - **スパースチェックアウトとは**: Gitの機能の一つで、リポジトリ全体をダウンロードせずに、指定したパス以下のファイルのみをローカルに取得する方法です。`GitPython` はこのGit機能をPythonから利用するためのライブラリです。これにより、大規模なリポジトリから必要なドキュメントのみを効率的に収集できます。
    - クローン後、`--temp-dir` 内の `--path-in-repo` で指定されたパスからMarkdownファイル（`.md`）やテキストファイル（`.txt`）などを識別し、後続の処理のためにそのパスを保持する。
3.  **結果の出力**: 収集したWebページコンテンツは一時ディレクトリに保存される。標準出力には、処理結果の概要をJSON形式で返す。
    ```json
    {
      "status": "success",
      "output_dir": "/path/to/temp_output_directory",
      "fetched_count": 15
    }
    ```
    `output_dir` 内には、収集された各ドキュメントファイルと、それらのファイルパス（リポジトリルートからの相対パス）とURLをマッピングする `discovery.json` ファイルが含まれることを想定する。
4.  **作法**:
  - エラーハンドリング（認証エラー、リポジリが見つからない、ネットワークエラーなど）や引数解析は、既存のツール（例: 旧 `make_vector_db.py`）の堅牢な作法を踏襲する。
  - 文書レベル、クラスレベル、メソッドレベルそれぞれにエージェントがコードを読まずとも理解するに足りるだけのDocstringsを用意する。
  - `samples/tool_sample.py`: エラーハンドリング、引数解析、JSON出力形式、Docstringsなどの作法を参考にすること！

## 参考とすべきスクリプト等
- `tools/web_fetch.py`: エラーハンドリング、引数解析、JSON出力形式などの作法を参考に。

## テスト方法
`github_fetch.py` の機能が正しく動作することを確認するため、以下のテストを実施する。

1.  **テストリポジトリの準備**: 取得可能なGitHubリポジトリのURLを用意する。
    - 例: `https://github.com/google-gemini/gemini-cli`
2.  **ツール実行**: `github_fetch.py` を、テストリポジトリのURL、一時ディレクトリ、およびリポジトリ内のパスを引数として実行する。
    - 例: `python github_fetch.py --repo-url "https://github.com/google-gemini/gemini-cli" --temp-dir "./temp_github_docs" --path-in-repo "docs"`
3.  **出力確認**:
    - 標準出力に、`status: success` を含むJSONが返されることを確認する。
    - 指定した `--temp-dir` にファイルが正しく保存されていること、および `discovery.json` が生成されていることを確認する。
    - `discovery.json` に、期待されるファイルパスとコンテンツが含まれていることを確認する。
