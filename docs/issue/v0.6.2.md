# Issue v0.6.2

## 前提知識
- docs/Architecture/Architecture.md
- src/ragmaker/tools/ask_dir.py
- src/ragmaker/tools/install_kb.py

## 用語の定義
- **RAGMakerリポジトリルート**: 本プロジェクトのソースコードが置かれているルートディレクトリ。
- **マスターツールカタログ**: RAGMakerリポジトリルート/discovery.json。全ツールの定義ファイル。
- **ナレッジベース（KB）**: 構築されたRAGの実体。
- **ドキュメントカタログ**: KB内にあるドキュメント目録ファイル（catalog.json）。
- **インストール先ディレクトリ**: ユーザーがKBを配置したいターゲットプロジェクト内のパス。

## 経緯
既存のナレッジベース（KB）を別のプロジェクト環境やディレクトリへ移行・セットアップする「インストール」プロセスの利便性を向上させるため、専用のスキル `rag-installer` を作成した。その過程で、ディレクトリ選択ツール `ragmaker-ask-dir` において、初期表示ディレクトリを指定できない不便さが露呈した。

## 現状の問題点
- `ragmaker-ask-dir` が常にシステムデフォルトのディレクトリから開くため、ターゲットディレクトリの選択時にカレントプロジェクトを探す手間が発生していた。
- `rag-installer` スキルのプロンプト（SKILL.md）において、エージェントが「論理的なツール名」と「実際の実行コマンド名」を混同し、存在しないフラグ（`--ask-dir` 等）を捏造するハルシネーションが発生していた。

## ゴール（完了の定義）
- [x] `ragmaker-ask-dir` に `--initial-dir` オプションが実装され、正常に動作する。
- [x] `rag-installer` スキルが新規作成され、`ragmaker-ask-dir` と `ragmaker-install-kb` を正しく連携させて動作する。
- [x] `SKILL.md` が最適化され、コマンド名を直接指定することでハルシネーションを排除した。
- [x] 新機能に対するテストコードが作成され、パスしている。

## 解決策の概要
- `src/ragmaker/tools/ask_dir.py` を修正し、`tkinter.filedialog.askdirectory` の `initialdir` 引数をコマンドラインから制御可能にした。
- `rag-installer` スキルを新規開発し、Windows互換性を考慮した `skill-installer` を用いてパッケージ化・配布した。
- プロンプトエンジニアリングを適用し、AIエージェントへの指示を「抽象的なツール呼び出し」から「具体的なコマンド実行」へと変更した。

## 解決策の詳細
1. **`ask_dir.py` の修正**:
   - `argparse` による `--initial-dir` 引数のサポート。
   - `ask_for_directory` 関数への引数伝搬。
2. **`rag-installer` スキルの実装**:
   - `SKILL.md` の作成：ソース選択、ターゲット選択、インストールの3ステップを定義。
3. **テストの拡充**:
   - `test/test_ask_dir.py` を新規作成。`unittest.mock` を用いて、GUIを表示させずに引数の受け渡しを検証。

## テスト方法
- [x] 新規テストファイル（`test/test_ask_dir.py`）を作成し、正常系（引数あり・なし）および異常系（キャンセル）を網羅した。
- [x] `python test/test_ask_dir.py` を実行し、パスすることを確認した。
- [x] `ragmaker-ask-dir --help` を実行し、オプションが公開されていることを確認した。

## 実装状況
- [x] `ask_dir.py` への `--initial-dir` 実装完了。
- [x] `test/test_ask_dir.py` による検証完了。
- [x] `rag-installer` スキルの作成および `user` スコープへのインストール完了。
- [x] `Architecture.md` におけるカタログファイル名の記述修正完了。