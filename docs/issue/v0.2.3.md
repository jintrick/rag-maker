# Issue v0.2.3: discovery.json 形式の統一と共通ユーティリティの導入

## 前提知識
- docs/Architecture/Architecture.md
- docs/issue/v0.2.2.md
- samples/document_discovery.json

## 現状の問題点
- `github_fetch.py` および `web_fetch.py` ツールが生成する `discovery.json` の形式が、`rag.toml` で期待される `samples/document_discovery.json` の形式と異なっている。
- 現在の `discovery.json` は `url` と `file_path` のリストのみであり、エージェントが後で `title` と `summary` を追加するための構造が不足している。
- `github_fetch.py` と `web_fetch.py` の間で `discovery.json` 生成ロジックが重複する可能性があり、共通化が必要。

## 解決策の概要
- `github_fetch.py` および `web_fetch.py` が `samples/document_discovery.json` の形式に準拠した `discovery.json` を生成するように修正する。
- `discovery.json` の生成ロジックを共通化するため、`utils.py` を新規作成し、関連するヘルパー関数をそこに集約する。

## 解決策の詳細
1.  **`utils.py` の新規作成**:
    - `tools/` ディレクトリ内に `utils.py` を作成する。
    - `discovery.json` の構造（`$schema`、`documents` 配列、各ドキュメントの `path`, `url`, `title`, `summary` フィールド）を定義するヘルパー関数やクラスを実装する。
    - `title` と `summary` は初期値として空の文字列 (`""`) を設定する。
    - `path` フィールドは、リポジトリルートからの相対パス（例: `docs/architecture.md`）とする。
    - `url` フィールドは、元のWebページまたはGitHub上のファイルのURLとする。
2.  **`github_fetch.py` の修正**:
    - `utils.py` から `discovery.json` 生成用のヘルパー関数をインポートし、それを利用して `discovery.json` を出力するように変更する。
    - `fetched_files_map` の構造を、`samples/document_discovery.json` の `documents` 配列内のオブジェクト形式に合わせる。
3.  **`web_fetch.py` の修正**:
    - `utils.py` から `discovery.json` 生成用のヘルパー関数をインポートし、それを利用して `discovery.json` を出力するように変更する。
    - `fetched_files_map` の構造を、`samples/document_discovery.json` の `documents` 配列内のオブジェクト形式に合わせる。

## 参考とすべきスクリプト等
- `samples/document_discovery.json`: 期待される `discovery.json` の形式。
- `tools/github_fetch.py` (修正前): 既存の `discovery.json` 生成ロジック。
- `tools/web_fetch.py` (修正前): 既存の `discovery.json` 生成ロジック。

## テスト方法
1.  `github_fetch.py` を実行する。
    - 例: `python tools/github_fetch.py --repo-url "https://github.com/google-gemini/gemini-cli" --temp-dir ".\.tmp\google-gemini\gemini-cli" --path-in-repo "docs"`
2.  生成された `discovery.json` の内容を確認する。
    - `samples/document_discovery.json` と同様の構造（`documents` キーを持つオブジェクト）になっていること。
    - 各ドキュメントエントリに `path`, `url`, `title`, `summary` フィールドが存在し、`title` と `summary` が空文字列で初期化されていること。
    - `fetched_count` と `documents` 配列の要素数が一致すること。
